function e(e){let t=new Date(e);return t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),t}document.addEventListener("DOMContentLoaded",()=>{console.log("Initializing data fetch"),document.getElementById("spinner").style.display="block",fetch("https://script.google.com/macros/s/AKfycbyTqzU-lZ2XFk6xvkwKqQq8eGHOX85k1hDxy1-Qj1Pw9KDQcvfKTQELQImNpenELfa9ew/exec").then(e=>{if(console.log(`Received response with status: ${e.status}`),!e.ok)throw Error(`Network response was not ok: ${e.statusText}`);return e.json()}).then(t=>{console.log("Fetched data:",t),function(t){document.getElementById("spinner").style.display="none",t.forEach((e,t)=>{e.id=t+1});let i=t.map(t=>({id:t.id,name:`${t.firstName} ${t.lastName}`,img:t.directPhotoUrl.replace("https://drive.google.com/uc?export=view&id=","https://drive.google.com/thumbnail?id="),pids:[],mid:null,fid:null,age:""==t.deathDate?"גיל: "+function(t){let i=e(t),r=new Date,o=r.getFullYear()-i.getFullYear();return(r.getMonth()<i.getMonth()||r.getMonth()===i.getMonth()&&r.getDate()<i.getDate())&&o--,o.toString()}(t.birthDate):function(t,i){let r=e(t),o=e(i),a=r.getFullYear(),n=o.getFullYear();return`${a} - ${n}`}(t.birthDate,t.deathDate)}));(function(e,t){e.forEach(i=>{if(i.spouseFirstName&&i.spouseLastName){let r=e.find(e=>e.firstName===i.spouseFirstName&&e.lastName===i.spouseLastName);r&&(t[i.id-1].pids.push(r.id),t[r.id-1].pids.push(i.id))}})})(t,i),t.forEach(e=>{let r=i[e.id-1],o=e.motherFirstName.split(" ")[0],a=e.fatherFirstName.split(" ")[0];if(o&&a){let e=t.filter(e=>e.firstName===o),n=t.filter(e=>e.firstName===a),s=null,l=null;for(let t of e){for(let e of n)if(i[t.id-1].pids.includes(e.id)){s=t,l=e;break}if(s&&l)break}s&&(r.mid=s.id),l&&(r.fid=l.id)}}),t.forEach(e=>{let r=e.motherFirstName.split(" ")[0],o=e.fatherFirstName.split(" ")[0];if(r&&o){let e=t.filter(e=>e.motherFirstName&&e.motherFirstName.split(" ")[0]===r&&e.fatherFirstName&&e.fatherFirstName.split(" ")[0]===o);e.sort((e,t)=>new Date(e.birthDate)-new Date(t.birthDate)),e.forEach((e,t)=>{i[e.id-1].siblingOrder=t})}}),i.sort((e,t)=>(e.siblingOrder||0)-(t.siblingOrder||0)),i[0].pids.pop(),i[1].pids.pop(),new FamilyTree(document.getElementById("tree"),{template:"john",dataSource:i,nodeBinding:{field_0:"name",field_1:"age",img_0:"img"},nodes:i,enableSearch:!1,nodeMouseClick:!1,partnerNodeSeparation:-119,levelSeparation:80,minPartnerSeparation:20}),console.log("Final Nodes:",i)}(t)}).catch(e=>{console.error("Fetch error:",e),document.getElementById("spinner").style.display="none"})});
//# sourceMappingURL=index.abc2d42d.js.map
